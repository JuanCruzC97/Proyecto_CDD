---
title: "Analisis Exploratorio"
output: html_document
---

# Paquetes

```{r Paquetes}
library(dplyr)
library(ggplot2)
library(corrplot)
library(fastDummies)
library(purrr)
library(tidyr)
library(readr)
```


# Dataset

```{r}
getwd()
data <- read_csv('Proyecto A/00 - Creación Dataset y Variables/Dataset_Modelos.csv')
```

# Funciones

La función permite generar un análisis rápido de una variable o atributo de un dataset. Toma como argumentos la columna y el dataframe, más el argumento histogram que es opcional y permite elegir entre gráfico de densidad o histograma.

EJ: attr_summary(data["X1"], data["phishing"], data, type = "cont")

* El atributo **type** indica el tipo de variable, si es continua irá *continua* y si es categorica irá *categorica*. Por default es continua.
* El atributo **cont_plot** permite elegir el tipo de gráfico en variable continua, entre *histograma* o *densidad*.


```{r Función Análisis de Atributos}

attr_summary <- function(variable, respuesta, data, type = "continua", cont_plot = "histograma", hist_position = "dodge", bar_position = "fill"){
  print("Resumen Estadístico")
  if (type == "continua"){
    variable <- as.numeric(variable)
  } else if (type == "categorica"){
    variable <- as.factor(variable)
  } else {
    print("Mal definido el tipo de variable: continua o categorica")
  }
  respuesta <- as.factor(respuesta)
  print(summary(variable))
  if (type == "continua"){
    print(paste("Desvío muestral:", round(sd(variable), 2)))
    print(paste("Coeficiente de variación:", round(sd(variable)/mean(variable), 2)))
  } else if (type == "categorica"){
    print(paste("Proporción Positivos:", table(variable)["1"]/(table(variable)["0"]+table(variable)["1"])))
    print("Filas corresponden a Variable - Columnas corresponden a la respuesta")
    print(table(data$suf_ru, data$phishing))
  }
  my_theme <- theme(plot.title = element_text(hjust = 0.5, size = 16),
                plot.background = element_blank(),
                panel.background = element_blank(),
                axis.line = element_line(colour = "black"),
                panel.grid.major = element_line(colour = "light grey", size = 0.2),
                panel.grid.minor = element_line(colour = "light grey", size = 0.2),
                axis.title.y = element_text(size = 14, hjust = 0.5),
                axis.title.x = element_text(size = 14, hjust = 0.5),
                axis.text = element_text(size = 11))
  
  
  if(type == "continua"){
    
    # Grafico de la distribución de la variable.
    if (cont_plot == "densidad") {
    print(ggplot(data, aes(x = variable))+
      geom_density()+
      labs(title = "Density Plot",
           x = "Atributo o Variable",
           y = "Densidad")+
      my_theme)
    } else if (cont_plot == "histograma") {
    print(ggplot(data, aes(x = variable))+
      geom_histogram(color="black", bins = 60)+
      labs(title = "Histogram",
           x = "Atributo o Variable",
           y = "Frecuencia")+
      my_theme)
    }
    
    # Graficos de la variable contra la respuesta.
    print(ggplot(data, aes(x = variable, fill = respuesta))+
      geom_histogram(alpha = 0.5, position = hist_position, bins = 60)+
      labs(title = "Histogram Plot",
          x = "Atributo o Variable",
          y = "Densidad")+
      my_theme)
    
    print(ggplot(data, aes(x = respuesta, y = variable, color = respuesta))+
      geom_boxplot()+
      labs(title = "BoxPlot",
          x = "Atributo o Variable",
          y = "Respuesta")+
      my_theme)
    
    
  } else if (type == "categorica"){
    print(ggplot(data, aes(x = variable))+
    geom_bar(alpha = 0.8, color = "black")+
    labs(title = "Barplot",
         x = "Atributo o Variable",
         y = "Frecuencia")+
    my_theme)
    
    print(ggplot(data, aes(x = variable, fill = respuesta))+
    geom_bar(alpha = 0.8, color = "black", position = bar_position)+
    labs(title = "Barplot",
         x = "Atributo o Variable",
         y = "Frecuencia")+
    my_theme)
    
  } else {
    print("Mal definido el tipo de variable: continua o categorica")
  
  }
}
```


# Análisis Exploratorio


```{r}
names(data)
```

```{r}
attr_summary(data$metric_amazon, data$phishing, data, type = "continua")
```


```{r}
attr_summary(data$suf_xyz, data$phishing, data, type = "categorica")
```











